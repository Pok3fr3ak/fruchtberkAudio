(this["webpackJsonpfruchtberkaudio-intermediateplayer"]=this["webpackJsonpfruchtberkaudio-intermediateplayer"]||[]).push([[0],{40:function(e,t,n){},41:function(e,t,n){},75:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),o=n(34),i=n.n(o),r=(n(40),n(2)),s=(n(41),n(35)),u=n(14),l=n.n(u),d=n(20),f=n(0),j=function(e){var t=function(e){return new Promise((function(t,n){var c,a=1/(e.duration/5);c="in"===e.direction?window.setInterval(Object(d.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e.player,t.t1=Math,t.next=4,e.player.getVolume();case 4:t.t2=t.sent,t.t3=a,t.t4=t.t2+t.t3,t.t5=t.t1.min.call(t.t1,1,t.t4),t.t0.setVolume.call(t.t0,t.t5);case 9:case"end":return t.stop()}}),t)}))),5):window.setInterval(Object(d.a)(l.a.mark((function t(){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.player.getVolume();case 2:n=t.sent,e.player.setVolume(Math.max(0,n-a));case 4:case"end":return t.stop()}}),t)}))),5),window.setTimeout((function(){clearInterval(c),t()}),e.duration)}))},n=Object(c.useState)(void 0),a=Object(r.a)(n,2),o=a[0],i=a[1],s=Object(c.useState)(""),u=Object(r.a)(s,2),j=u[0],b=u[1],p=Object(c.useState)(!1),m=Object(r.a)(p,2),O=m[0],h=m[1],y=Object(c.useState)(!1),v=Object(r.a)(y,2),g=(v[0],v[1]),w=Object(c.useState)({name:"",album:{images:[{url:""}]},artists:[{name:""}]}),x=Object(r.a)(w,2),k=x[0],_=x[1],S=Object(c.useState)(0),P=Object(r.a)(S,2),T=P[0],N=P[1],I=Object(c.useState)(0),E=Object(r.a)(I,2),A=E[0],D=E[1],L=Object(c.useState)(2e3),C=Object(r.a)(L,2),F=C[0];C[1];return Object(c.useEffect)((function(){var t=document.createElement("script");t.src="https://sdk.scdn.co/spotify-player.js",t.async=!0,document.body.appendChild(t),window.onSpotifyWebPlaybackSDKReady=function(){var t=new window.Spotify.Player({name:"Web Playback SDK",getOAuthToken:function(t){t(e.token)},volume:.5});i(t),t.addListener("ready",(function(e){var t=e.device_id;b(t),console.log("Ready with Device ID",t,t)})),t.addListener("not_ready",(function(e){var t=e.device_id;console.log("Device ID has gone offline",t)})),t.addListener("playback_error",(function(e){console.log(e)})),t.addListener("player_state_changed",(function(e){e&&(D(Math.floor(e.position/1e3)),N(e.duration),_(e.track_window.current_track),h(e.paused),t.getCurrentState().then((function(e){g(!!e)})))})),t.connect()}}),[]),Object(c.useEffect)((function(){var n=e.socket;if(void 0!==o&&void 0!==j&&""!==j)return console.log("ADDED EVENTLISTENERS"),n.on("play",(function(e){console.log("GOT PLAY"),!0===O&&(o.togglePlay(),console.log("Toggled Pla")),console.log("PLAY"),t({direction:"out",duration:F,player:o}).then((function(){var n;(n={playerInstance:o,id:j,spotify_uri:e},new Promise((function(e,t){n.playerInstance._options.getOAuthToken((function(t){fetch("https://api.spotify.com/v1/me/player/play?device_id=".concat(n.id),{method:"PUT",body:JSON.stringify({context_uri:n.spotify_uri}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then((function(){e()}))}))}))).then((function(){t({direction:"in",duration:F,player:o})}))}))})),n.on("pause",(function(){!0===O&&o.togglePlay()})),n.on("crossfade",(function(){})),function(){n.offAny()}}),[o,j]),Object(c.useEffect)((function(){var e;return!1===O&&(e=window.setInterval((function(){D((function(e){return e+1}))}),1e3)),function(){clearInterval(e)}}),[A]),Object(f.jsx)(f.Fragment,{children:void 0!==o?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("div",{className:"container",children:Object(f.jsxs)("div",{className:"main-wrapper",children:[Object(f.jsx)("img",{src:k.album.images[0].url,className:"now-playing__cover",alt:""}),Object(f.jsxs)("div",{className:"now-playing__side",children:[Object(f.jsx)("div",{className:"now-playing__name",children:k.name}),Object(f.jsx)("div",{}),Object(f.jsx)("div",{className:"now-playing__artist",children:k.artists[0].name}),Object(f.jsx)("div",{children:A}),Object(f.jsx)("div",{children:"".concat(Math.floor(T/1e3/60),":").concat(Math.floor(T/1e3%60))})]})]})}),Object(f.jsx)("button",{className:"btn-spotify",onClick:function(){o.previousTrack()},children:"<<"}),Object(f.jsx)("button",{className:"btn-spotify",onClick:function(){o.togglePlay()},children:O?"PLAY":"PAUSE"}),Object(f.jsx)("button",{className:"btn-spotify",onClick:function(){o.nextTrack()},children:">>"})]}):Object(f.jsx)(f.Fragment,{})})};var b=function(){var e=Object(s.io)("http://localhost:3500"),t=Object(c.useState)(""),n=Object(r.a)(t,2),a=n[0],o=n[1];return Object(c.useEffect)((function(){e.on("initalToken",(function(t){o(t),setInterval((function(){e.emit("requestNewToken")}),36e5)})),e.on("recievedToken",(function(e){o(e)}))}),[]),Object(f.jsx)("div",{className:"App",children:""!==a?Object(f.jsx)(j,{token:a,socket:e}):Object(f.jsx)(f.Fragment,{})})},p=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,76)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),o(e),i(e)}))};i.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(b,{})}),document.getElementById("root")),p()}},[[75,1,2]]]);
//# sourceMappingURL=main.55d5b4ea.chunk.js.map